<main class="commande-container">
  <div class="commande">
    <!-- Titre -->
    <div class="titre">
      <h1>Gestion des commandes</h1>
      <p class="sous-titre">Suivez, filtrez et gérez toutes les commandes clients.</p>
    </div>

    <!-- Recherche et filtres -->
    <div class="search-filter">
      <!-- Recherche -->
      <input
        type="text"
        class="search-box"
        placeholder="Rechercher par client ou numéro de commande"
        [(ngModel)]="searchTerm"
      />

      <!-- Filtre Statut -->
      <select class="filter-btn" [(ngModel)]="selectedStatus">
        <option value="all">Tous les statuts</option>
        <option value="en_attente">En attente</option>
        <option value="confirmee">Confirmée</option>
        <option value="en_cours">En cours</option>
        <option value="livree">Livrée</option>
        <option value="annulee">Annulée</option>
      </select>

      <!-- Filtre Date -->
      <input type="date" class="filter-btn" [(ngModel)]="selectedDate" />
    </div>

    <!-- Tableau commandes -->
    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>Numéro</th>
            <th>Client</th>
            <th>Date</th>
            <th>Montant total</th>
            <th>Statut</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let cmd of pagedCommandes">
            <td>#{{ cmd.code_commande }}</td>
            <td>{{ cmd.user.nom }}</td>
            <td>{{ cmd.created_at | date: 'dd/MM/yyyy' }}</td>
            <td>{{ cmd.total | number:'1.0-0' }} FCFA</td>
            <td>
                <select
                  class="status-select"
                  [(ngModel)]="cmd.statut_commande"
                  (change)="changerStatut(cmd.id, cmd.statut_commande)"
                >
                  <option value="en_attente">En attente</option>
                  <option value="confirmee">Confirmée</option>
                  <option value="en_cours">En cours</option>
                  <option value="livree">Livrée</option>
                  <option value="annulee">Annulée</option>
                </select>
              </td>
              <td>
                <a (click)="voirCommande(cmd.id)" class="action-btn voir">Voir</a>
                <a (click)="modifierCommande(cmd.id)" class="action-btn editer">Modifier</a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Pagination -->
    <div class="pagination">
      <button (click)="prevPage()" [disabled]="currentPage === 1">Précédent</button>
      <span>Page {{ currentPage }}</span>
      <button
        (click)="nextPage()"
        [disabled]="currentPage * pageSize >= filteredCommandes.length"
      >
        Suivant
      </button>
    </div>
  </div>
</main>
