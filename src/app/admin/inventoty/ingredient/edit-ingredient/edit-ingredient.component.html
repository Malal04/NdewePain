<main class="ingredient-form-container">
  <h2><i class="fa fa-carrot"></i> Modifier un Ingrédient</h2>

  <!-- Messages globaux -->
  <p class="message success" *ngIf="message && !error">{{ message }}</p>
  <p class="message error" *ngIf="error">{{ error }}</p>

  <form [formGroup]="ingredientForm" (ngSubmit)="onSubmit()">
    <!-- Nom -->
    <div class="form-group">
      <label for="nom">Nom <span>*</span></label>
      <input
        id="nom"
        type="text"
        formControlName="nom"
        placeholder="Ex : Farine"
      />
      <div class="error" *ngIf="f['nom'].touched && f['nom'].invalid">
        <small *ngIf="f['nom'].errors?.['required']">
          Le nom est obligatoire.
        </small>
        <small *ngIf="f['nom'].errors?.['maxlength']">
          Max 255 caractères.
        </small>
      </div>
    </div>

    <!-- Quantité -->
    <div class="form-group">
      <label for="quantite">Quantité <span>*</span></label>
      <input
        id="quantite"
        type="number"
        formControlName="quantite"
        placeholder="Ex : 100"
      />
      <div class="error" *ngIf="f['quantite'].touched && f['quantite'].invalid">
        <small *ngIf="f['quantite'].errors?.['required']">
          La quantité est obligatoire.
        </small>
        <small *ngIf="f['quantite'].errors?.['min']">
          La quantité doit être ≥ 0.
        </small>
      </div>
    </div>

    <!-- Unité -->
    <div class="form-group">
      <label for="unite">Unité <span>*</span></label>
      <input
        id="unite"
        type="text"
        formControlName="unite"
        placeholder="Ex : kg, L, sachet"
      />
      <div class="error" *ngIf="f['unite'].touched && f['unite'].invalid">
        <small *ngIf="f['unite'].errors?.['required']">
          L’unité est obligatoire.
        </small>
        <small *ngIf="f['unite'].errors?.['maxlength']">
          Max 50 caractères.
        </small>
      </div>
    </div>

    <!-- Seuil -->
    <div class="form-group">
      <label for="seuil_reappro">Seuil de réapprovisionnement <span>*</span></label>
      <input
        id="seuil_reappro"
        type="number"
        formControlName="seuil_reappro"
        placeholder="Ex : 10"
      />
      <div class="error" *ngIf="f['seuil_reappro'].touched && f['seuil_reappro'].invalid">
        <small *ngIf="f['seuil_reappro'].errors?.['required']">
          Le seuil est obligatoire.
        </small>
        <small *ngIf="f['seuil_reappro'].errors?.['min']">
          Le seuil doit être ≥ 0.
        </small>
      </div>
    </div>

    <!-- Fournisseur -->
    <div class="form-group">
      <label for="supplier_id">Fournisseur <span>*</span></label>
      <select id="supplier_id" formControlName="supplier_id">
        <option value="">-- Sélectionner un fournisseur --</option>
        <option *ngFor="let sup of suppliers" [value]="sup.id">
          {{ sup.nom }} — {{ sup.contact_person }}
        </option>
      </select>
      <div class="error" *ngIf="f['supplier_id'].touched && f['supplier_id'].invalid">
        <small *ngIf="f['supplier_id'].errors?.['required']">
          Le fournisseur est obligatoire.
        </small>
      </div>
    </div>

    <!-- Boutons -->
    <div class="form-actions">
      <button type="submit" [disabled]="ingredientForm.invalid" class="btn btn-primary">
        <i class="fa fa-save"></i> Mettre à jour
      </button>
      <button type="button" (click)="cancel()" class="btn btn-secondary">
        <i class="fa fa-times"></i> Annuler
      </button>
    </div>
  </form>
</main>
